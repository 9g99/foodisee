<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>근처 맛집 찾기</title>
</head>
<body>
  <h1>내 주변 맛집 리스트</h1>
  <ul id="places"></ul>

  <script>
    const places = [
      { name: "문래 맛집 1", lat: 37.5189, lng: 126.8946 },
      { name: "문래 맛집 2", lat: 37.5180, lng: 126.8932 },
      { name: "문래 맛집 3", lat: 37.5175, lng: 126.8961 },
      { name: "영등포구청 맛집 1", lat: 37.5242, lng: 126.8953 },
      { name: "영등포구청 맛집 2", lat: 37.5248, lng: 126.8925 },
      { name: "영등포구청 맛집 3", lat: 37.5235, lng: 126.8940 },
      { name: "영등포 맛집 1", lat: 37.5150, lng: 126.9075 },
      { name: "영등포 맛집 2", lat: 37.5161, lng: 126.9080 },
      { name: "영등포 맛집 3", lat: 37.5165, lng: 126.9050 },
      { name: "영등포 맛집 4", lat: 37.5170, lng: 126.9060 },
    ];

    function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    navigator.geolocation.getCurrentPosition(function(position) {
      const userLat = position.coords.latitude;
      const userLng = position.coords.longitude;

      const nearby = places.filter(place => {
        const distance = getDistanceFromLatLonInKm(userLat, userLng, place.lat, place.lng);
        return distance < 2; // 2km 이내만 표시
      });

      const ul = document.getElementById('places');
      nearby.forEach(place => {
        const li = document.createElement('li');
        li.innerHTML = `<a href="https://maps.google.com/?q=${place.lat},${place.lng}" target="_blank">${place.name}</a>`;
        ul.appendChild(li);
      });

      if (nearby.length === 0) {
        ul.innerHTML = '<li>근처에 등록된 맛집이 없습니다.</li>';
      }
    }, function(error) {
      alert('위치 정보 접근이 거부되었습니다. 위치 권한을 허용해주세요.');
    });
  </script>
</body>
</html>
